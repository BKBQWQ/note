# exec 1>&0 ，重定向输出

### linux下的文件描述符：

1. 在 Linux 系统中，文件描述符（File Descriptor，FD）是一种用于标识 **已打开文件**（或更广泛地说，任何 I/O 资源，包括网络套接字、设备等）的非负整数。
2. 文件描述符从0开始编号：**标准输入**（stdin）、**标准输出**（stdout）和 **标准错误输出**（stderr）通常拥有固定的文件描述符 0、1 和 2，后买你再打开一个文件就从3开始编号。
3. 文件关闭：使用 **close** 函数可以通过文件描述符来关闭一个文件，例如：关闭标准输出 **close(1)** 。
4. 以下是一些与文件描述符相关的常见 Linux 系统调用：
   - **open**：打开一个文件并返回一个文件描述符。
   - **close**：关闭一个文件描述符。
   - **read**：从指定的文件描述符读取数据。
   - **write**：向指定的文件描述符写入数据。
   - **lseek**：改变文件描述符的文件偏移量。
   - **fcntl**：对文件描述符执行各种控制操作，如设置标志、复制文件描述符等。
   - **dup** 和 **dup2**：复制文件描述符。

### 重定向：

1.  重定向 **标准输出** ： **exec  1>文件名** 或者 **exec 1>&+文件描述符** ，例如 **exec 1>&0** 将标准输出重定向到标准输入。
2. 重定向 **标准输入** ：**exec 0<文件名** 或者 **exec 0<&+文件描述符** 。 
3. 标准输入输出的指向是默认的，我们可以修改它们的指向，也即 **重定位** 。
4. 可以用 **exec 1>myoutput** 把标准输出重定向到myoutput文件中，也可以用 **exec 0<myinput** 把标准输入重定向到myinput文件中，而且， **文件名字可以用&+文件描述符 **来代替。



### 例题：[BUUCTF在线评测 (buuoj.cn)](https://buuoj.cn/challenges#wustctf2020_closed)

1. ida中可以看到，程序里面关闭了 **标准输出（1）** 和 **标准错误输出（2）** ，然后直接给了shell，但是内存连接上后输入都没有任何显示，其实现在已经拿到shell并cat flag了，但是程序关闭了标准输出，所以不会有显示。

   ![image-20240705090957600](https://gitee.com/poppy-qwq/cloudimage/raw/master/img/202407050909661.png)

   ![image-20240705091158254](https://gitee.com/poppy-qwq/cloudimage/raw/master/img/202407050911309.png)

2. 可以使用重定向，将标准输出重定向到标准输入，这样就能再终端上显示输出的flag，其实打开一个程序，标准输入、标准输出和错误输出都是指向当前终端的，执行 **exec 1>&0** 就相当于重新开启了标准输出，也可以将标准错误输出一起重定向到标准输入，这样程序里面的close(1)和close(2)就相当于没用了。

   ![image-20240705091914794](https://gitee.com/poppy-qwq/cloudimage/raw/master/img/202407050919849.png)